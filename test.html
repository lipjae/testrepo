<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    #my-scrollbar {
      height: 100vh;
      overflow: hidden;
    }
    .section {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2em;
      color: white;
    }
    .first {
      background-color: blue;
    }
    .second {
      background-color: green;
    }
    .third {
      background-color: red;
    }
  </style>
</head>
<body>
  <div id="my-scrollbar">
    <div class="section first">First Section</div>
    <div class="section second">Second Section</div>
    <div class="section third">Third Section</div>
  </div>

  <script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/gsap@3/dist/ScrollTrigger.min.js"></script>
  <script src="https://unpkg.com/smooth-scrollbar@8.6.3/dist/smooth-scrollbar.js"></script>
  <script>
    gsap.registerPlugin(ScrollTrigger);

    // Initialize Smooth Scrollbar
    const bodyScrollBar = Scrollbar.init(document.querySelector('#my-scrollbar'), {
      damping: 0.1,
    });

    // Tell ScrollTrigger to use these proxy getter/setter methods for the "body" element
    ScrollTrigger.scrollerProxy('#my-scrollbar', {
      scrollTop(value) {
        if (arguments.length) {
          bodyScrollBar.scrollTop = value; // setter
        }
        return bodyScrollBar.scrollTop; // getter
      },
      getBoundingClientRect() {
        return {
          top: 0,
          left: 0,
          width: window.innerWidth,
          height: window.innerHeight,
        };
      },
      pinType: document.querySelector('#my-scrollbar').style.transform ? 'transform' : 'fixed',
    });

    // When the smooth scroller updates, tell ScrollTrigger to update() too
    bodyScrollBar.addListener(ScrollTrigger.update);

    // Set default scroller for all ScrollTriggers
    ScrollTrigger.defaults({ scroller: '#my-scrollbar' });

    ScrollTrigger.create({
        trigger: ".first",
        start: "top top",
        end: "bottom top",
        pin: true,
        pinSpacing: false,
        scroller: '#my-scrollbar'
    });

    // 두 번째 섹션 애니메이션
    gsap.to(".second", {
        scrollTrigger: {
        trigger: ".second",
        start: "top bottom",
        end: "top top",
        scrub: true,
        scroller: '#my-scrollbar'
        },
        yPercent: -100
    });

    // 세 번째 섹션 애니메이션
    gsap.to(".third", {
        scrollTrigger: {
        trigger: ".third",
        start: "top bottom",
        end: "top top",
        scrub: true,
        scroller: '#my-scrollbar'
        },
        yPercent: -100
    });

    // Refresh ScrollTrigger and Smooth Scrollbar when the page is loaded
    ScrollTrigger.addEventListener('refresh', () => bodyScrollBar.update());
    ScrollTrigger.refresh();
  </script>
</body>
</html>
